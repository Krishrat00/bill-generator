<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>E-Way Bill Generation</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="p-4">
  <div class="container">
    <h4 class="mb-3">Step 1: Send SMS to Generate E-Way Bill</h4>
    <p>Send the following SMS to <b>7738299899</b>:</p>

    <div class="alert alert-light border">
      <code id="smsText"></code>
    </div>

    <p>Once you receive the E-Way Bill Number (EWB No) from SMS reply, enter it below:</p>

    <form id="ewbForm">
      <div class="mb-3">
        <label for="ewbNo" class="form-label">EWB Number:</label>
        <input type="text" id="ewbNo" class="form-control" required>
      </div>

      <button type="button" id="openEWBPage" class="btn btn-success">Download EWB from Official Site</button>
    </form>
  </div>

  <script>
  const invoiceData = JSON.parse(sessionStorage.getItem("current_invoice") || "{}");
  console.log("Invoice Data:", invoiceData);
  const sms = `EWBG OSUP 24AHJPR6707K1ZY ${invoiceData.party_gstin || ""} ${invoiceData.pin || ""} ${invoiceData.invoice_no || ""} ${invoiceData.date?.replaceAll("-", "") || ""} ${invoiceData.total_value || ""} ${invoiceData.hsn || "5407"} ${invoiceData.distance || "50"} ${invoiceData.vehicle || ""}`;
  document.getElementById("smsText").textContent = sms;

  document.getElementById("openEWBPage").addEventListener("click", async () => {
    const ewbNo = document.getElementById("ewbNo").value.trim();
    if (!ewbNo) return alert("Please enter the EWB number first!");

    const payload = {
      ewb_no: ewbNo,
    //   invoice_no: invoiceData.invoice_no,
            invoice_no: '',
        gstin: '24AHJPR6707K1ZY',
      date: '27-10-2025',
    };
    console.log(payload)
    window.location.href = "https://ewaybillgst.gov.in/Others/EBPrintnew.aspx"
    // window.open("https://ewaybillgst.gov.in/Others/EBPrintnew.aspx");

  });
</script>

</body>
</html>
